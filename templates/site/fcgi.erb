server {
  listen   <%= listen %> ;
	server_name  <% real_server_name.each do |s_n| -%><%= s_n %> <% end -%>;
  access_log  <%= real_access_log %>;
  error_log <%= real_error_log %> <%= error_log_level %>;
  root <%= root %>;
  index <%= index %>;

<% if listen == '443' %>
  ssl on;
  ssl_certificate <%= real_ssl_certificate %>;
  ssl_certificate_key <%= real_ssl_certificate_key %>;

  ssl_session_timeout <%= ssl_session_timeout %>;

  ssl_protocols SSLv2 SSLv3 TLSv1;
  ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
  ssl_prefer_server_ciphers on;
<% end -%>

  ## Images and static content is treated different
  location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {
    access_log        off;
    expires           30d;
    root <%= root %>;
  }

	location ~ \.php$ {
	  fastcgi_index <%= index %>;
	  
	  
	  
    if (-f $request_filename) {
      fastcgi_pass <%= fastcgi_pass %>;
    }
		fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
		include /etc/nginx/includes/fastcgi_params.inc;
		<% fastcgi_params.each_pair do |param, value| -%>
		   fastcgi_param <%= param %> <%= value %>;
        <% end -%>
	}

  ## Disable viewing .htaccess & .htpassword
	location ~ /\.ht {
    deny all;
  }

<% if include != '' -%>
<% include.each do |inc| -%>
  include <%= inc %>;
<% end -%>
<% end -%>
}
